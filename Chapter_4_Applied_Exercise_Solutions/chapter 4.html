<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shad Ali Shah">
<meta name="dcterms.date" content="2025-12-02">

<title>Statistical Learning Analysis Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="chapter 4_files/libs/clipboard/clipboard.min.js"></script>
<script src="chapter 4_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="chapter 4_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="chapter 4_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="chapter 4_files/libs/quarto-html/popper.min.js"></script>
<script src="chapter 4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="chapter 4_files/libs/quarto-html/anchor.min.js"></script>
<link href="chapter 4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chapter 4_files/libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="chapter 4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="chapter 4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="chapter 4_files/libs/bootstrap/bootstrap-4d7f0bce1131f3e5f9547cd857cfbfc8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#exercise-13" id="toc-exercise-13" class="nav-link active" data-scroll-target="#exercise-13"><span class="header-section-number">1</span> Exercise 13</a></li>
  <li><a href="#exercise-14" id="toc-exercise-14" class="nav-link" data-scroll-target="#exercise-14"><span class="header-section-number">2</span> Exercise 14</a></li>
  <li><a href="#exercise-15" id="toc-exercise-15" class="nav-link" data-scroll-target="#exercise-15"><span class="header-section-number">3</span> Exercise 15</a></li>
  <li><a href="#exercise-16" id="toc-exercise-16" class="nav-link" data-scroll-target="#exercise-16"><span class="header-section-number">4</span> Exercise 16</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Statistical Learning Analysis Report</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Chapter 4: ISLR2 Exercise Solutions</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shad Ali Shah </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 2, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="exercise-13" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="exercise-13"><span class="header-section-number">1</span> Exercise 13</h2>
<div id="f7e4da2c" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ISLP</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ISLP <span class="im">import</span> load_data</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ISLP.models <span class="im">import</span> (ModelSpec <span class="im">as</span> MS,summarize)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> <span class="op">\</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>     (LinearDiscriminantAnalysis <span class="im">as</span> LDA,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      QuadraticDiscriminantAnalysis <span class="im">as</span> QDA)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="a2531752" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Weekly<span class="op">=</span>load_data(<span class="st">"Weekly"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="33678b7d" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Weekly.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Lag1</th>
<th data-quarto-table-cell-role="th">Lag2</th>
<th data-quarto-table-cell-role="th">Lag3</th>
<th data-quarto-table-cell-role="th">Lag4</th>
<th data-quarto-table-cell-role="th">Lag5</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">Today</th>
<th data-quarto-table-cell-role="th">Direction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>1990</td>
<td>0.816</td>
<td>1.572</td>
<td>-3.936</td>
<td>-0.229</td>
<td>-3.484</td>
<td>0.154976</td>
<td>-0.270</td>
<td>Down</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>1990</td>
<td>-0.270</td>
<td>0.816</td>
<td>1.572</td>
<td>-3.936</td>
<td>-0.229</td>
<td>0.148574</td>
<td>-2.576</td>
<td>Down</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>1990</td>
<td>-2.576</td>
<td>-0.270</td>
<td>0.816</td>
<td>1.572</td>
<td>-3.936</td>
<td>0.159837</td>
<td>3.514</td>
<td>Up</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>1990</td>
<td>3.514</td>
<td>-2.576</td>
<td>-0.270</td>
<td>0.816</td>
<td>1.572</td>
<td>0.161630</td>
<td>0.712</td>
<td>Up</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>1990</td>
<td>0.712</td>
<td>3.514</td>
<td>-2.576</td>
<td>-0.270</td>
<td>0.816</td>
<td>0.153728</td>
<td>1.178</td>
<td>Up</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="a" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="a"><span class="header-section-number">1.1</span> (a)</h3>
<p>First step to look for patterns is to draw statistical description of data. For this we can use the method describe() as follows:</p>
<div id="4c9266fe" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Weekly.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Lag1</th>
<th data-quarto-table-cell-role="th">Lag2</th>
<th data-quarto-table-cell-role="th">Lag3</th>
<th data-quarto-table-cell-role="th">Lag4</th>
<th data-quarto-table-cell-role="th">Lag5</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">Today</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>1089.000000</td>
<td>1089.000000</td>
<td>1089.000000</td>
<td>1089.000000</td>
<td>1089.000000</td>
<td>1089.000000</td>
<td>1089.000000</td>
<td>1089.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>2000.048669</td>
<td>0.150585</td>
<td>0.151079</td>
<td>0.147205</td>
<td>0.145818</td>
<td>0.139893</td>
<td>1.574618</td>
<td>0.149899</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>6.033182</td>
<td>2.357013</td>
<td>2.357254</td>
<td>2.360502</td>
<td>2.360279</td>
<td>2.361285</td>
<td>1.686636</td>
<td>2.356927</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>1990.000000</td>
<td>-18.195000</td>
<td>-18.195000</td>
<td>-18.195000</td>
<td>-18.195000</td>
<td>-18.195000</td>
<td>0.087465</td>
<td>-18.195000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>1995.000000</td>
<td>-1.154000</td>
<td>-1.154000</td>
<td>-1.158000</td>
<td>-1.158000</td>
<td>-1.166000</td>
<td>0.332022</td>
<td>-1.154000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>2000.000000</td>
<td>0.241000</td>
<td>0.241000</td>
<td>0.241000</td>
<td>0.238000</td>
<td>0.234000</td>
<td>1.002680</td>
<td>0.241000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>2005.000000</td>
<td>1.405000</td>
<td>1.409000</td>
<td>1.409000</td>
<td>1.409000</td>
<td>1.405000</td>
<td>2.053727</td>
<td>1.405000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>2010.000000</td>
<td>12.026000</td>
<td>12.026000</td>
<td>12.026000</td>
<td>12.026000</td>
<td>12.026000</td>
<td>9.328214</td>
<td>12.026000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ac740dd4" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Weekly.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Lag1</th>
<th data-quarto-table-cell-role="th">Lag2</th>
<th data-quarto-table-cell-role="th">Lag3</th>
<th data-quarto-table-cell-role="th">Lag4</th>
<th data-quarto-table-cell-role="th">Lag5</th>
<th data-quarto-table-cell-role="th">Volume</th>
<th data-quarto-table-cell-role="th">Today</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Year</th>
<td>1.000000</td>
<td>-0.032289</td>
<td>-0.033390</td>
<td>-0.030006</td>
<td>-0.031128</td>
<td>-0.030519</td>
<td>0.841942</td>
<td>-0.032460</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Lag1</th>
<td>-0.032289</td>
<td>1.000000</td>
<td>-0.074853</td>
<td>0.058636</td>
<td>-0.071274</td>
<td>-0.008183</td>
<td>-0.064951</td>
<td>-0.075032</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Lag2</th>
<td>-0.033390</td>
<td>-0.074853</td>
<td>1.000000</td>
<td>-0.075721</td>
<td>0.058382</td>
<td>-0.072499</td>
<td>-0.085513</td>
<td>0.059167</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Lag3</th>
<td>-0.030006</td>
<td>0.058636</td>
<td>-0.075721</td>
<td>1.000000</td>
<td>-0.075396</td>
<td>0.060657</td>
<td>-0.069288</td>
<td>-0.071244</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Lag4</th>
<td>-0.031128</td>
<td>-0.071274</td>
<td>0.058382</td>
<td>-0.075396</td>
<td>1.000000</td>
<td>-0.075675</td>
<td>-0.061075</td>
<td>-0.007826</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Lag5</th>
<td>-0.030519</td>
<td>-0.008183</td>
<td>-0.072499</td>
<td>0.060657</td>
<td>-0.075675</td>
<td>1.000000</td>
<td>-0.058517</td>
<td>0.011013</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Volume</th>
<td>0.841942</td>
<td>-0.064951</td>
<td>-0.085513</td>
<td>-0.069288</td>
<td>-0.061075</td>
<td>-0.058517</td>
<td>1.000000</td>
<td>-0.033078</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Today</th>
<td>-0.032460</td>
<td>-0.075032</td>
<td>0.059167</td>
<td>-0.071244</td>
<td>-0.007826</td>
<td>0.011013</td>
<td>-0.033078</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Thanks to the correlation matrix, the only predictible trend is between Volume and Year. But let’s draw graphs as the question asks.</p>
<div id="bb25f822" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(Weekly)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter%204_files/figure-html/cell-7-output-1.png" width="1886" height="1885" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cfc1df8c" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(Weekly[<span class="st">'Year'</span>],Weekly[<span class="st">'Volume'</span>])<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter%204_files/figure-html/cell-8-output-1.png" width="522" height="337" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Given the plots shown above, the only visible pattern is the one which relates Year to Volume</p>
</section>
<section id="b" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="b"><span class="header-section-number">1.2</span> (b)</h3>
<div id="ba26722c" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>allvars<span class="op">=</span>Weekly.columns.drop([<span class="st">'Today'</span>,<span class="st">'Direction'</span>,<span class="st">'Year'</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>design<span class="op">=</span>MS(allvars)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>design.fit_transform(Weekly)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>Weekly.Direction<span class="op">==</span><span class="st">'Up'</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>glm<span class="op">=</span>sm.GLM(y,X,family<span class="op">=</span>sm.families.Binomial())</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>res<span class="op">=</span>glm.fit()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>res.summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<table class="simpletable caption-top table table-sm table-striped small">
<caption>Generalized Linear Model Regression Results</caption>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dep. Variable:</th>
<td>Direction</td>
<th data-quarto-table-cell-role="th">No. Observations:</th>
<td>1089</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Model:</th>
<td>GLM</td>
<th data-quarto-table-cell-role="th">Df Residuals:</th>
<td>1082</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Model Family:</th>
<td>Binomial</td>
<th data-quarto-table-cell-role="th">Df Model:</th>
<td>6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Link Function:</th>
<td>Logit</td>
<th data-quarto-table-cell-role="th">Scale:</th>
<td>1.0000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Method:</th>
<td>IRLS</td>
<th data-quarto-table-cell-role="th">Log-Likelihood:</th>
<td>-743.18</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Date:</th>
<td>Tue, 02 Dec 2025</td>
<th data-quarto-table-cell-role="th">Deviance:</th>
<td>1486.4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Time:</th>
<td>11:40:57</td>
<th data-quarto-table-cell-role="th">Pearson chi2:</th>
<td>1.09e+03</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">No. Iterations:</th>
<td>4</td>
<th data-quarto-table-cell-role="th">Pseudo R-squ. (CS):</th>
<td>0.009000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Covariance Type:</th>
<td>nonrobust</td>
<th data-quarto-table-cell-role="th"></th>
<td></td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<td></td>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">intercept</th>
<td>0.2669</td>
<td>0.086</td>
<td>3.106</td>
<td>0.002</td>
<td>0.098</td>
<td>0.435</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Lag1</th>
<td>-0.0413</td>
<td>0.026</td>
<td>-1.563</td>
<td>0.118</td>
<td>-0.093</td>
<td>0.010</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Lag2</th>
<td>0.0584</td>
<td>0.027</td>
<td>2.175</td>
<td>0.030</td>
<td>0.006</td>
<td>0.111</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Lag3</th>
<td>-0.0161</td>
<td>0.027</td>
<td>-0.602</td>
<td>0.547</td>
<td>-0.068</td>
<td>0.036</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Lag4</th>
<td>-0.0278</td>
<td>0.026</td>
<td>-1.050</td>
<td>0.294</td>
<td>-0.080</td>
<td>0.024</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Lag5</th>
<td>-0.0145</td>
<td>0.026</td>
<td>-0.549</td>
<td>0.583</td>
<td>-0.066</td>
<td>0.037</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Volume</th>
<td>-0.0227</td>
<td>0.037</td>
<td>-0.616</td>
<td>0.538</td>
<td>-0.095</td>
<td>0.050</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Only Lag2 seems to be statistically significant.</p>
</section>
<section id="c" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="c"><span class="header-section-number">1.3</span> (c)</h3>
<div id="43957323" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>probs<span class="op">=</span>res.predict()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>np.array([<span class="st">'Down'</span>]<span class="op">*</span><span class="dv">1089</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>labels[probs<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="st">"Up"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="a6c7b2a3" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(labels,Weekly.Direction)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">Down</th>
<th data-quarto-table-cell-role="th">Up</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Down</th>
<td>54</td>
<td>48</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Up</th>
<td>430</td>
<td>557</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e37e78b0" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">557</span><span class="op">+</span><span class="dv">54</span>)<span class="op">/</span>(<span class="dv">54</span><span class="op">+</span><span class="dv">557</span><span class="op">+</span><span class="dv">430</span><span class="op">+</span><span class="dv">48</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>0.5610651974288338</code></pre>
</div>
</div>
<p>The accuracy rate is 56%, slightly better than random guessing. Given that we chose that ‘up’ is the positive direction, the error rate is mainly due to false positive classification. Which means that 430 stocks are predicted to go up by the model while they truly go down.</p>
</section>
<section id="d" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="d"><span class="header-section-number">1.4</span> (d)</h3>
<div id="a1b916f5" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting the asked period and the corresponding training set with Lag2 as the only predictor</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>train<span class="op">=</span>(Weekly.Year<span class="op">&lt;</span><span class="dv">2009</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>W_train<span class="op">=</span>Weekly.loc[train].Lag2</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>W_test<span class="op">=</span>Weekly.loc[<span class="op">~</span>train].Lag2</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>W_test.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(104,)</code></pre>
</div>
</div>
<div id="245becaf" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Refitting the new model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test <span class="op">=</span> X.loc[train].Lag2, X.loc[<span class="op">~</span>train].Lag2</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>y_train, y_test <span class="op">=</span> y.loc[train], y.loc[<span class="op">~</span>train]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>glm_train <span class="op">=</span> sm.GLM(y_train,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                   X_train,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                   family<span class="op">=</span>sm.families.Binomial())</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> glm_train.fit()</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Designing the probabilities based on the training set</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> results.predict(exog<span class="op">=</span>X_test)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>X_t<span class="op">=</span>np.array(X_train)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>XX<span class="op">=</span>X_t.reshape(np.shape(X_t)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>X_ts<span class="op">=</span>np.array(X_test)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>Xts<span class="op">=</span>X_ts.reshape(np.shape(X_ts)[<span class="dv">0</span>],<span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="1630a5e2" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Preparing the test set to compare with the corresponding training set in the confusion matrix</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>D<span class="op">=</span>Weekly.Direction</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Test_set<span class="op">=</span>D.loc[<span class="op">~</span>train]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>Train_set<span class="op">=</span>D.loc[train]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting the probs matrix to a matrix filled with direction values</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>np.array([<span class="st">'Down'</span>]<span class="op">*</span><span class="dv">104</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>labels[probs<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="st">'Up'</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>C<span class="op">=</span>ISLP.confusion_table(labels,Test_set)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>Train_s<span class="op">=</span>np.array(Train_set)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>TT<span class="op">=</span>Train_s.reshape(np.shape(Train_set)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>Test_s<span class="op">=</span>np.array(Test_set)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>TS<span class="op">=</span>Test_s.reshape(np.shape(Test_s)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>TS.shape</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(104, 1)</code></pre>
</div>
</div>
<div id="d6b52c31" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>C</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">Down</th>
<th data-quarto-table-cell-role="th">Up</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Down</th>
<td>20</td>
<td>24</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Up</th>
<td>23</td>
<td>37</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="009509be" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">20</span><span class="op">+</span><span class="dv">37</span>)<span class="op">/</span><span class="dv">104</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>0.5480769230769231</code></pre>
</div>
</div>
<p>The rate of correct predictions on the held out data is around 55%.</p>
</section>
<section id="e" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="e"><span class="header-section-number">1.5</span> (e)</h3>
<div id="5999e064" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lda<span class="op">=</span>LDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lda.fit(XX, Train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearDiscriminantAnalysis(store_covariance=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LinearDiscriminantAnalysis<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html">?<span>Documentation for LinearDiscriminantAnalysis</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LinearDiscriminantAnalysis(store_covariance=True)</pre></div> </div></div></div></div>
</div>
</div>
<div id="1f8614a0" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>lda_pred<span class="op">=</span>lda.predict(Xts)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>lda_predm<span class="op">=</span>np.array(lda_pred)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>lda_predm1<span class="op">=</span>lda_predm.reshape(np.shape(lda_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(lda_predm1,TS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">Down</th>
<th data-quarto-table-cell-role="th">Up</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Down</th>
<td>9</td>
<td>5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Up</th>
<td>34</td>
<td>56</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ed98fac3" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">9</span><span class="op">+</span><span class="dv">56</span>)<span class="op">/</span><span class="dv">104</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>0.625</code></pre>
</div>
</div>
<p>LDA performs better than logistic regression since Lag2 seems to follow a normal distribution from the previous correlation plot.</p>
</section>
<section id="f" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="f"><span class="header-section-number">1.6</span> (f)</h3>
<div id="50080a23" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>qda<span class="op">=</span>QDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>qda.fit(XX, Train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>QuadraticDiscriminantAnalysis(store_covariance=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;QuadraticDiscriminantAnalysis<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis.html">?<span>Documentation for QuadraticDiscriminantAnalysis</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>QuadraticDiscriminantAnalysis(store_covariance=True)</pre></div> </div></div></div></div>
</div>
</div>
<div id="6a69e042" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>qda_pred<span class="op">=</span>qda.predict(Xts)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>qda_predm<span class="op">=</span>np.array(qda_pred)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>qda_predm1<span class="op">=</span>qda_predm.reshape(np.shape(lda_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(qda_predm1,TS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">Down</th>
<th data-quarto-table-cell-role="th">Up</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Down</th>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Up</th>
<td>43</td>
<td>61</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4e48fc85" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dv">61</span><span class="op">/</span>(<span class="dv">61</span><span class="op">+</span><span class="dv">43</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0.5865384615384616</code></pre>
</div>
</div>
<p>Fraction of correct answers for QDA is around 59%, which means that it is lower than LDA but better than logistic regression. The QDA is better here than logistic regression for the same reason as for the LDA. However, LDA gives a better prediction than QDA since there are no signs of interactions among predictors.</p>
</section>
<section id="g" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="g"><span class="header-section-number">1.7</span> (g)</h3>
<div id="c6280300" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>knn1 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>knn1.fit(XX, Train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<style>#sk-container-id-3 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-3 {
  color: var(--sklearn-color-text);
}

#sk-container-id-3 pre {
  padding: 0;
}

#sk-container-id-3 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-3 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-3 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-3 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-3 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-3 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-3 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-3 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-3 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-3 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-3 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-3 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-3 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-3 div.sk-label label.sk-toggleable__label,
#sk-container-id-3 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-3 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-3 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-3 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-3 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-3 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-3 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-3 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-3 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-3 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsClassifier(n_neighbors=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;KNeighborsClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.neighbors.KNeighborsClassifier.html">?<span>Documentation for KNeighborsClassifier</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>KNeighborsClassifier(n_neighbors=1)</pre></div> </div></div></div></div>
</div>
</div>
<div id="75fe4200" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>knn1_pred<span class="op">=</span>knn1.predict(Xts)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>knn1_predm<span class="op">=</span>np.array(knn1_pred)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>knn1_predm1<span class="op">=</span>knn1_predm.reshape(np.shape(knn1_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(knn1_predm1,TS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">Down</th>
<th data-quarto-table-cell-role="th">Up</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Down</th>
<td>22</td>
<td>31</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Up</th>
<td>21</td>
<td>30</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="444a9ce7" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">22</span><span class="op">+</span><span class="dv">30</span>)<span class="op">/</span><span class="dv">104</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0.5</code></pre>
</div>
</div>
<p>Since the LDA outperforms QDA we can already expect that KNN will perform poorly. The decision boundary should be linear. Furthermore, the rate giving the number of observations over the number of predictors is around 17, which is not large enough to justify such a non parametric technique.</p>
</section>
<section id="h" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="h"><span class="header-section-number">1.8</span> (h)</h3>
<div id="124220cb" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>NB <span class="op">=</span> GaussianNB()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>NB.fit(XX, Train_set)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<style>#sk-container-id-4 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-4 {
  color: var(--sklearn-color-text);
}

#sk-container-id-4 pre {
  padding: 0;
}

#sk-container-id-4 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-4 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-4 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-4 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-4 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-4 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-4 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-4 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-4 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-4 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-4 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-4 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-4 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-4 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-4 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-4 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-4 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-4 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-4 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-4 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-4 div.sk-label label.sk-toggleable__label,
#sk-container-id-4 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-4 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-4 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-4 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-4 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-4 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-4 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-4 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-4 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-4 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-4 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-4 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked=""><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GaussianNB<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.naive_bayes.GaussianNB.html">?<span>Documentation for GaussianNB</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GaussianNB()</pre></div> </div></div></div></div>
</div>
</div>
<div id="41d30d1a" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>NB_pred<span class="op">=</span>NB.predict(Xts)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>NB_predm<span class="op">=</span>np.array(NB_pred)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>NB_predm1<span class="op">=</span>NB_predm.reshape(np.shape(NB_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(NB_predm1,TS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">Down</th>
<th data-quarto-table-cell-role="th">Up</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Down</th>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Up</th>
<td>43</td>
<td>61</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="817a47e0" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="dv">61</span><span class="op">/</span><span class="dv">104</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0.5865384615384616</code></pre>
</div>
</div>
</section>
<section id="i" class="level3" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="i"><span class="header-section-number">1.9</span> (i)</h3>
<p>LDA appears to give the best results on the data set.</p>
</section>
</section>
<section id="exercise-14" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="exercise-14"><span class="header-section-number">2</span> Exercise 14</h2>
<section id="a-1" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="a-1"><span class="header-section-number">2.1</span> (a)</h3>
<div id="85fdac72" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Auto<span class="op">=</span>load_data(<span class="st">"Auto"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="abdb54ab" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Auto.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">origin</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">chevrolet chevelle malibu</th>
<td>18.0</td>
<td>8</td>
<td>307.0</td>
<td>130</td>
<td>3504</td>
<td>12.0</td>
<td>70</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">buick skylark 320</th>
<td>15.0</td>
<td>8</td>
<td>350.0</td>
<td>165</td>
<td>3693</td>
<td>11.5</td>
<td>70</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">plymouth satellite</th>
<td>18.0</td>
<td>8</td>
<td>318.0</td>
<td>150</td>
<td>3436</td>
<td>11.0</td>
<td>70</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">amc rebel sst</th>
<td>16.0</td>
<td>8</td>
<td>304.0</td>
<td>150</td>
<td>3433</td>
<td>12.0</td>
<td>70</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ford torino</th>
<td>17.0</td>
<td>8</td>
<td>302.0</td>
<td>140</td>
<td>3449</td>
<td>10.5</td>
<td>70</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="3a632d26" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mpg01<span class="op">=</span>np.where(Auto[<span class="st">"mpg"</span>]<span class="op">&gt;</span>Auto[<span class="st">"mpg"</span>].median(),<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="57e5a090" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Auto[<span class="st">'mpg01'</span>]<span class="op">=</span>mpg01</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="b-1" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="b-1"><span class="header-section-number">2.2</span> (b)</h3>
<div id="fe35bb2e" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Auto.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cylinders</th>
<th data-quarto-table-cell-role="th">displacement</th>
<th data-quarto-table-cell-role="th">horsepower</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">acceleration</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">mpg01</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">mpg</th>
<td>1.000000</td>
<td>-0.777618</td>
<td>-0.805127</td>
<td>-0.778427</td>
<td>-0.832244</td>
<td>0.423329</td>
<td>0.580541</td>
<td>0.565209</td>
<td>0.836939</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">cylinders</th>
<td>-0.777618</td>
<td>1.000000</td>
<td>0.950823</td>
<td>0.842983</td>
<td>0.897527</td>
<td>-0.504683</td>
<td>-0.345647</td>
<td>-0.568932</td>
<td>-0.759194</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">displacement</th>
<td>-0.805127</td>
<td>0.950823</td>
<td>1.000000</td>
<td>0.897257</td>
<td>0.932994</td>
<td>-0.543800</td>
<td>-0.369855</td>
<td>-0.614535</td>
<td>-0.753477</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">horsepower</th>
<td>-0.778427</td>
<td>0.842983</td>
<td>0.897257</td>
<td>1.000000</td>
<td>0.864538</td>
<td>-0.689196</td>
<td>-0.416361</td>
<td>-0.455171</td>
<td>-0.667053</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">weight</th>
<td>-0.832244</td>
<td>0.897527</td>
<td>0.932994</td>
<td>0.864538</td>
<td>1.000000</td>
<td>-0.416839</td>
<td>-0.309120</td>
<td>-0.585005</td>
<td>-0.757757</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">acceleration</th>
<td>0.423329</td>
<td>-0.504683</td>
<td>-0.543800</td>
<td>-0.689196</td>
<td>-0.416839</td>
<td>1.000000</td>
<td>0.290316</td>
<td>0.212746</td>
<td>0.346822</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">year</th>
<td>0.580541</td>
<td>-0.345647</td>
<td>-0.369855</td>
<td>-0.416361</td>
<td>-0.309120</td>
<td>0.290316</td>
<td>1.000000</td>
<td>0.181528</td>
<td>0.429904</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">origin</th>
<td>0.565209</td>
<td>-0.568932</td>
<td>-0.614535</td>
<td>-0.455171</td>
<td>-0.585005</td>
<td>0.212746</td>
<td>0.181528</td>
<td>1.000000</td>
<td>0.513698</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">mpg01</th>
<td>0.836939</td>
<td>-0.759194</td>
<td>-0.753477</td>
<td>-0.667053</td>
<td>-0.757757</td>
<td>0.346822</td>
<td>0.429904</td>
<td>0.513698</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ffe7cfb0" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(Auto)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter%204_files/figure-html/cell-35-output-1.png" width="2121" height="2121" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>From the graph and the correlation matrix we can conclude that there may be a significant correlation among mpg01, displacement, weight and cylinders.</p>
<div id="d61e2e95" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>Auto[[<span class="st">'weight'</span>,<span class="st">'displacement'</span>,<span class="st">'cylinders'</span>]].values</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#the values attribute is used to convert x from a dataframe object to an array</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>Auto[<span class="st">'mpg01'</span>].values</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="c-1" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="c-1"><span class="header-section-number">2.3</span> (c)</h3>
<div id="877e0a20" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(X_train,X_test,y_train,y_test) <span class="op">=</span> train_test_split(x,y,random_state<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="d-1" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="d-1"><span class="header-section-number">2.4</span> (d)</h3>
<div id="ba81cbb0" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lda<span class="op">=</span>LDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>lda.fit(X_train, y_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<style>#sk-container-id-5 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-5 {
  color: var(--sklearn-color-text);
}

#sk-container-id-5 pre {
  padding: 0;
}

#sk-container-id-5 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-5 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-5 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-5 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-5 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-5 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-5 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-5 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-5 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-5 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-5 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-5 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-5 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-5 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-5 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-5 div.sk-label label.sk-toggleable__label,
#sk-container-id-5 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-5 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-5 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-5 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-5 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-5 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-5 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-5 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-5 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-5 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearDiscriminantAnalysis(store_covariance=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked=""><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LinearDiscriminantAnalysis<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html">?<span>Documentation for LinearDiscriminantAnalysis</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LinearDiscriminantAnalysis(store_covariance=True)</pre></div> </div></div></div></div>
</div>
</div>
<div id="ac300a7e" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lda_pred<span class="op">=</span>lda.predict(X_test)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(lda_pred,y_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>49</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>5</td>
<td>42</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ec324dfe" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">49</span><span class="op">+</span><span class="dv">42</span>)<span class="op">/</span>(<span class="dv">49</span><span class="op">+</span><span class="dv">42</span><span class="op">+</span><span class="dv">5</span><span class="op">+</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>0.9285714285714286</code></pre>
</div>
</div>
<div id="76bf509a" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>LDA_test_err<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, lda.predict(X_test))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>LDA_test_err</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>0.0714285714285714</code></pre>
</div>
</div>
<p>The test error obtained for the LDA model is 7%.</p>
</section>
<section id="e-1" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="e-1"><span class="header-section-number">2.5</span> (e)</h3>
<div id="e81e2fbc" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>qda<span class="op">=</span>QDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>qda.fit(X_train, y_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<style>#sk-container-id-6 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-6 {
  color: var(--sklearn-color-text);
}

#sk-container-id-6 pre {
  padding: 0;
}

#sk-container-id-6 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-6 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-6 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-6 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-6 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-6 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-6 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-6 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-6 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-6 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-6 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-6 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-6 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-6 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-6 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-6 div.sk-label label.sk-toggleable__label,
#sk-container-id-6 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-6 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-6 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-6 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-6 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-6 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-6 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-6 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-6 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-6 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>QuadraticDiscriminantAnalysis(store_covariance=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" checked=""><label for="sk-estimator-id-6" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;QuadraticDiscriminantAnalysis<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis.html">?<span>Documentation for QuadraticDiscriminantAnalysis</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>QuadraticDiscriminantAnalysis(store_covariance=True)</pre></div> </div></div></div></div>
</div>
</div>
<div id="605551d0" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>qda_pred<span class="op">=</span>qda.predict(X_test)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>QDA_test_err<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, qda.predict(X_test))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>QDA_test_err</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>0.061224489795918324</code></pre>
</div>
</div>
<p>The test error obtained for the LDA model is 6%.</p>
</section>
<section id="f-1" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="f-1"><span class="header-section-number">2.6</span> (f)</h3>
<div id="50ae74c3" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>lr<span class="op">=</span>LogisticRegression()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>result<span class="op">=</span>lr.fit(X_train,y_train)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>lr_test_error<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, lr.predict(X_test))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>lr_test_error</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>0.061224489795918324</code></pre>
</div>
</div>
<p>The test error obtained for the logistic regression model is 6%.</p>
</section>
<section id="g-1" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="g-1"><span class="header-section-number">2.7</span> (g)</h3>
<div id="657090c8" class="cell" data-execution_count="44">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>NB <span class="op">=</span> GaussianNB()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>NB.fit(X_train, y_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="44">
<style>#sk-container-id-7 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-7 {
  color: var(--sklearn-color-text);
}

#sk-container-id-7 pre {
  padding: 0;
}

#sk-container-id-7 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-7 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-7 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-7 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-7 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-7 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-7 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-7 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-7 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-7 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-7 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-7 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-7 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-7 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-7 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-7 div.sk-label label.sk-toggleable__label,
#sk-container-id-7 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-7 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-7 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-7 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-7 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-7 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-7 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-7 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-7 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-7 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" checked=""><label for="sk-estimator-id-7" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GaussianNB<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.naive_bayes.GaussianNB.html">?<span>Documentation for GaussianNB</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GaussianNB()</pre></div> </div></div></div></div>
</div>
</div>
<div id="57a6d9e7" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>NB_pred<span class="op">=</span>NB.predict(X_test)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>NB_test_error<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, NB_pred)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>NB_test_error</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>0.0714285714285714</code></pre>
</div>
</div>
<p>The test error obtained for Naive Bayes model is 7%.</p>
</section>
<section id="h-1" class="level3" data-number="2.8">
<h3 data-number="2.8" class="anchored" data-anchor-id="h-1"><span class="header-section-number">2.8</span> (h)</h3>
<div id="305dfef7" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">101</span>):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>k)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    knn.fit(X_train, y_train)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> accuracy_score(y_test, knn.predict(X_test))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'K=</span><span class="sc">{:3}</span><span class="st">, accuracy = </span><span class="sc">{:.4f}</span><span class="st">'</span>.<span class="bu">format</span>(k, acc))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>K=  1, accuracy = 0.8469
K=  2, accuracy = 0.8776
K=  3, accuracy = 0.8673
K=  4, accuracy = 0.8776
K=  5, accuracy = 0.8571
K=  6, accuracy = 0.8878
K=  7, accuracy = 0.8776
K=  8, accuracy = 0.9082
K=  9, accuracy = 0.8980
K= 10, accuracy = 0.8878
K= 11, accuracy = 0.9082
K= 12, accuracy = 0.9082
K= 13, accuracy = 0.9184
K= 14, accuracy = 0.9082
K= 15, accuracy = 0.8980
K= 16, accuracy = 0.8980
K= 17, accuracy = 0.8878
K= 18, accuracy = 0.9184
K= 19, accuracy = 0.9082
K= 20, accuracy = 0.9184
K= 21, accuracy = 0.9082
K= 22, accuracy = 0.9082
K= 23, accuracy = 0.9082
K= 24, accuracy = 0.9184
K= 25, accuracy = 0.9082
K= 26, accuracy = 0.9184
K= 27, accuracy = 0.9184
K= 28, accuracy = 0.9184
K= 29, accuracy = 0.9184
K= 30, accuracy = 0.9184
K= 31, accuracy = 0.9184
K= 32, accuracy = 0.9184
K= 33, accuracy = 0.9082
K= 34, accuracy = 0.9082
K= 35, accuracy = 0.8980
K= 36, accuracy = 0.9082
K= 37, accuracy = 0.8980
K= 38, accuracy = 0.8980
K= 39, accuracy = 0.8980
K= 40, accuracy = 0.8980
K= 41, accuracy = 0.8980
K= 42, accuracy = 0.8980
K= 43, accuracy = 0.8980
K= 44, accuracy = 0.9082
K= 45, accuracy = 0.8980
K= 46, accuracy = 0.8980
K= 47, accuracy = 0.8980
K= 48, accuracy = 0.8980
K= 49, accuracy = 0.8980
K= 50, accuracy = 0.8980
K= 51, accuracy = 0.8980
K= 52, accuracy = 0.8980
K= 53, accuracy = 0.8980
K= 54, accuracy = 0.8980
K= 55, accuracy = 0.8980
K= 56, accuracy = 0.8980
K= 57, accuracy = 0.8980
K= 58, accuracy = 0.8980
K= 59, accuracy = 0.8980
K= 60, accuracy = 0.8980
K= 61, accuracy = 0.8980
K= 62, accuracy = 0.8980
K= 63, accuracy = 0.8980
K= 64, accuracy = 0.8980
K= 65, accuracy = 0.8980
K= 66, accuracy = 0.8980
K= 67, accuracy = 0.8980
K= 68, accuracy = 0.8980
K= 69, accuracy = 0.8980
K= 70, accuracy = 0.8980
K= 71, accuracy = 0.8878
K= 72, accuracy = 0.8980
K= 73, accuracy = 0.8980
K= 74, accuracy = 0.8980
K= 75, accuracy = 0.8980
K= 76, accuracy = 0.8980
K= 77, accuracy = 0.8878
K= 78, accuracy = 0.8980
K= 79, accuracy = 0.8980
K= 80, accuracy = 0.8980
K= 81, accuracy = 0.8980
K= 82, accuracy = 0.8980
K= 83, accuracy = 0.8878
K= 84, accuracy = 0.8980
K= 85, accuracy = 0.8980
K= 86, accuracy = 0.8980
K= 87, accuracy = 0.8980
K= 88, accuracy = 0.8980
K= 89, accuracy = 0.8878
K= 90, accuracy = 0.8878
K= 91, accuracy = 0.8878
K= 92, accuracy = 0.8980
K= 93, accuracy = 0.8878
K= 94, accuracy = 0.8878
K= 95, accuracy = 0.8878
K= 96, accuracy = 0.8878
K= 97, accuracy = 0.8878
K= 98, accuracy = 0.8878
K= 99, accuracy = 0.8878
K=100, accuracy = 0.8980</code></pre>
</div>
</div>
<p>The value of 13 for K seems to give the best result for the KNN model.</p>
</section>
</section>
<section id="exercise-15" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="exercise-15"><span class="header-section-number">3</span> Exercise 15</h2>
<section id="a-2" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="a-2"><span class="header-section-number">3.1</span> (a)</h3>
<div id="adff695f" class="cell" data-execution_count="47">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Power():</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">2</span><span class="op">**</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="b-2" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="b-2"><span class="header-section-number">3.2</span> (b)</h3>
<div id="25933d3a" class="cell" data-execution_count="48">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Power2(x,a):</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x<span class="op">**</span>a)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="c-2" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="c-2"><span class="header-section-number">3.3</span> (c)</h3>
<div id="c58c2591" class="cell" data-execution_count="49">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>Power2(<span class="dv">10</span>,<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1000</code></pre>
</div>
</div>
<div id="b07d1c58" class="cell" data-execution_count="50">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>Power2(<span class="dv">8</span>,<span class="dv">17</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>2251799813685248</code></pre>
</div>
</div>
<div id="d42b90be" class="cell" data-execution_count="51">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Power2(<span class="dv">131</span>,<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>2248091</code></pre>
</div>
</div>
</section>
<section id="d-2" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="d-2"><span class="header-section-number">3.4</span> (d)</h3>
<div id="f706f911" class="cell" data-execution_count="52">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Power3(x,a):</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">**</span>a</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="e-2" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="e-2"><span class="header-section-number">3.5</span> (e)</h3>
<div id="d8a79be8" class="cell" data-execution_count="53">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> Power3(x,<span class="dv">2</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Power3() with x^2 vs x on log-scale'</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y=x^2'</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter%204_files/figure-html/cell-54-output-1.png" width="967" height="968" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a847afa6" class="cell" data-execution_count="54">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Power3() with x^2 vs x, both on log-scale'</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'log(x^2)'</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter%204_files/figure-html/cell-55-output-1.png" width="973" height="968" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f-2" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="f-2"><span class="header-section-number">3.6</span> (f)</h3>
<div id="bdf1742e" class="cell" data-execution_count="55">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> PlotPower(x,a,log<span class="op">=</span><span class="st">''</span>):</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'x^%.0f vs x'</span> <span class="op">%</span>a)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log<span class="op">==</span><span class="st">'xy'</span>:</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>        ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>        ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'x^%.0f vs x, both on log-scale'</span><span class="op">%</span>a)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'log(x^%.0f)'</span><span class="op">%</span>a)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log<span class="op">==</span><span class="st">'x'</span>:</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>        ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'x^%.0f vs log(x)'</span><span class="op">%</span>a)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'x^%.0f'</span><span class="op">%</span>a)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log<span class="op">==</span><span class="st">'y'</span>:</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>        ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'log(x^%.0f) vs x'</span><span class="op">%</span>a)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'log(x^%.0f)'</span><span class="op">%</span>a)  </span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>    ax.plot(x,y)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="exercise-16" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="exercise-16"><span class="header-section-number">4</span> Exercise 16</h2>
<div id="d2216247" class="cell" data-execution_count="56">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Boston<span class="op">=</span>load_data(<span class="st">'Boston'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="749024b1" class="cell" data-execution_count="57">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a response variable and add it to the Boston data set</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 for crim_ab means that crime rate is above the median</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>crim_ab<span class="op">=</span>np.where(Boston[<span class="st">"crim"</span>]<span class="op">&gt;</span>Boston[<span class="st">"crim"</span>].median(),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>Boston[<span class="st">'crim_ab'</span>]<span class="op">=</span>crim_ab</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="75539a12" class="cell" data-execution_count="58">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Boston[<span class="st">'crim_ab'</span>].describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>count    506.000000
mean       0.500000
std        0.500495
min        0.000000
25%        0.000000
50%        0.500000
75%        1.000000
max        1.000000
Name: crim_ab, dtype: float64</code></pre>
</div>
</div>
<div id="a2b6c918" class="cell" data-execution_count="59">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>Boston.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">crim</th>
<th data-quarto-table-cell-role="th">zn</th>
<th data-quarto-table-cell-role="th">indus</th>
<th data-quarto-table-cell-role="th">chas</th>
<th data-quarto-table-cell-role="th">nox</th>
<th data-quarto-table-cell-role="th">rm</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">dis</th>
<th data-quarto-table-cell-role="th">rad</th>
<th data-quarto-table-cell-role="th">tax</th>
<th data-quarto-table-cell-role="th">ptratio</th>
<th data-quarto-table-cell-role="th">lstat</th>
<th data-quarto-table-cell-role="th">medv</th>
<th data-quarto-table-cell-role="th">crim_ab</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">crim</th>
<td>1.000000</td>
<td>-0.200469</td>
<td>0.406583</td>
<td>-0.055892</td>
<td>0.420972</td>
<td>-0.219247</td>
<td>0.352734</td>
<td>-0.379670</td>
<td>0.625505</td>
<td>0.582764</td>
<td>0.289946</td>
<td>0.455621</td>
<td>-0.388305</td>
<td>0.409395</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">zn</th>
<td>-0.200469</td>
<td>1.000000</td>
<td>-0.533828</td>
<td>-0.042697</td>
<td>-0.516604</td>
<td>0.311991</td>
<td>-0.569537</td>
<td>0.664408</td>
<td>-0.311948</td>
<td>-0.314563</td>
<td>-0.391679</td>
<td>-0.412995</td>
<td>0.360445</td>
<td>-0.436151</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">indus</th>
<td>0.406583</td>
<td>-0.533828</td>
<td>1.000000</td>
<td>0.062938</td>
<td>0.763651</td>
<td>-0.391676</td>
<td>0.644779</td>
<td>-0.708027</td>
<td>0.595129</td>
<td>0.720760</td>
<td>0.383248</td>
<td>0.603800</td>
<td>-0.483725</td>
<td>0.603260</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">chas</th>
<td>-0.055892</td>
<td>-0.042697</td>
<td>0.062938</td>
<td>1.000000</td>
<td>0.091203</td>
<td>0.091251</td>
<td>0.086518</td>
<td>-0.099176</td>
<td>-0.007368</td>
<td>-0.035587</td>
<td>-0.121515</td>
<td>-0.053929</td>
<td>0.175260</td>
<td>0.070097</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">nox</th>
<td>0.420972</td>
<td>-0.516604</td>
<td>0.763651</td>
<td>0.091203</td>
<td>1.000000</td>
<td>-0.302188</td>
<td>0.731470</td>
<td>-0.769230</td>
<td>0.611441</td>
<td>0.668023</td>
<td>0.188933</td>
<td>0.590879</td>
<td>-0.427321</td>
<td>0.723235</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">rm</th>
<td>-0.219247</td>
<td>0.311991</td>
<td>-0.391676</td>
<td>0.091251</td>
<td>-0.302188</td>
<td>1.000000</td>
<td>-0.240265</td>
<td>0.205246</td>
<td>-0.209847</td>
<td>-0.292048</td>
<td>-0.355501</td>
<td>-0.613808</td>
<td>0.695360</td>
<td>-0.156372</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">age</th>
<td>0.352734</td>
<td>-0.569537</td>
<td>0.644779</td>
<td>0.086518</td>
<td>0.731470</td>
<td>-0.240265</td>
<td>1.000000</td>
<td>-0.747881</td>
<td>0.456022</td>
<td>0.506456</td>
<td>0.261515</td>
<td>0.602339</td>
<td>-0.376955</td>
<td>0.613940</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">dis</th>
<td>-0.379670</td>
<td>0.664408</td>
<td>-0.708027</td>
<td>-0.099176</td>
<td>-0.769230</td>
<td>0.205246</td>
<td>-0.747881</td>
<td>1.000000</td>
<td>-0.494588</td>
<td>-0.534432</td>
<td>-0.232471</td>
<td>-0.496996</td>
<td>0.249929</td>
<td>-0.616342</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">rad</th>
<td>0.625505</td>
<td>-0.311948</td>
<td>0.595129</td>
<td>-0.007368</td>
<td>0.611441</td>
<td>-0.209847</td>
<td>0.456022</td>
<td>-0.494588</td>
<td>1.000000</td>
<td>0.910228</td>
<td>0.464741</td>
<td>0.488676</td>
<td>-0.381626</td>
<td>0.619786</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">tax</th>
<td>0.582764</td>
<td>-0.314563</td>
<td>0.720760</td>
<td>-0.035587</td>
<td>0.668023</td>
<td>-0.292048</td>
<td>0.506456</td>
<td>-0.534432</td>
<td>0.910228</td>
<td>1.000000</td>
<td>0.460853</td>
<td>0.543993</td>
<td>-0.468536</td>
<td>0.608741</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ptratio</th>
<td>0.289946</td>
<td>-0.391679</td>
<td>0.383248</td>
<td>-0.121515</td>
<td>0.188933</td>
<td>-0.355501</td>
<td>0.261515</td>
<td>-0.232471</td>
<td>0.464741</td>
<td>0.460853</td>
<td>1.000000</td>
<td>0.374044</td>
<td>-0.507787</td>
<td>0.253568</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">lstat</th>
<td>0.455621</td>
<td>-0.412995</td>
<td>0.603800</td>
<td>-0.053929</td>
<td>0.590879</td>
<td>-0.613808</td>
<td>0.602339</td>
<td>-0.496996</td>
<td>0.488676</td>
<td>0.543993</td>
<td>0.374044</td>
<td>1.000000</td>
<td>-0.737663</td>
<td>0.453263</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">medv</th>
<td>-0.388305</td>
<td>0.360445</td>
<td>-0.483725</td>
<td>0.175260</td>
<td>-0.427321</td>
<td>0.695360</td>
<td>-0.376955</td>
<td>0.249929</td>
<td>-0.381626</td>
<td>-0.468536</td>
<td>-0.507787</td>
<td>-0.737663</td>
<td>1.000000</td>
<td>-0.263017</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">crim_ab</th>
<td>0.409395</td>
<td>-0.436151</td>
<td>0.603260</td>
<td>0.070097</td>
<td>0.723235</td>
<td>-0.156372</td>
<td>0.613940</td>
<td>-0.616342</td>
<td>0.619786</td>
<td>0.608741</td>
<td>0.253568</td>
<td>0.453263</td>
<td>-0.263017</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Features age, dis, nox, rad, tax and indus seem to be correlated with crim_ab.</p>
<div id="1025fcf9" class="cell" data-execution_count="60">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data set into training and test data set</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>Boston[[<span class="st">'indus'</span>,<span class="st">'nox'</span>,<span class="st">'age'</span>,<span class="st">'dis'</span>,<span class="st">'rad'</span>,<span class="st">'tax'</span>]].values</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#the values attribute is used to convert x from a dataframe object to an array</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>Boston[<span class="st">'crim_ab'</span>].values</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>(x_train,x_test,y_train,y_test)<span class="op">=</span>train_test_split(x,y,random_state<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="0d67e995" class="cell" data-execution_count="61">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>allvars<span class="op">=</span>Boston[[<span class="st">'indus'</span>,<span class="st">'nox'</span>,<span class="st">'age'</span>,<span class="st">'dis'</span>,<span class="st">'rad'</span>,<span class="st">'tax'</span>]]</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>design<span class="op">=</span>MS(allvars)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>design.fit_transform(Boston)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>Y<span class="op">=</span>Boston.crim_ab<span class="op">==</span><span class="dv">1</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>glm<span class="op">=</span>sm.GLM(Y,X,family<span class="op">=</span>sm.families.Binomial())</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>res<span class="op">=</span>glm.fit()</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>res.summary()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="61">
<table class="simpletable caption-top table table-sm table-striped small">
<caption>Generalized Linear Model Regression Results</caption>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dep. Variable:</th>
<td>crim_ab</td>
<th data-quarto-table-cell-role="th">No. Observations:</th>
<td>506</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Model:</th>
<td>GLM</td>
<th data-quarto-table-cell-role="th">Df Residuals:</th>
<td>499</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Model Family:</th>
<td>Binomial</td>
<th data-quarto-table-cell-role="th">Df Model:</th>
<td>6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Link Function:</th>
<td>Logit</td>
<th data-quarto-table-cell-role="th">Scale:</th>
<td>1.0000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Method:</th>
<td>IRLS</td>
<th data-quarto-table-cell-role="th">Log-Likelihood:</th>
<td>-122.38</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Date:</th>
<td>Tue, 02 Dec 2025</td>
<th data-quarto-table-cell-role="th">Deviance:</th>
<td>244.77</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Time:</th>
<td>11:41:08</td>
<th data-quarto-table-cell-role="th">Pearson chi2:</th>
<td>294.</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">No. Iterations:</th>
<td>9</td>
<th data-quarto-table-cell-role="th">Pseudo R-squ. (CS):</th>
<td>0.5945</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Covariance Type:</th>
<td>nonrobust</td>
<th data-quarto-table-cell-role="th"></th>
<td></td>
</tr>
</tbody>
</table>


<table class="simpletable caption-top table table-sm table-striped small">
<tbody>
<tr class="odd">
<td></td>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">intercept</th>
<td>-24.5072</td>
<td>3.744</td>
<td>-6.545</td>
<td>0.000</td>
<td>-31.846</td>
<td>-17.168</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">indus</th>
<td>-0.0576</td>
<td>0.042</td>
<td>-1.360</td>
<td>0.174</td>
<td>-0.141</td>
<td>0.025</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">nox</th>
<td>42.0938</td>
<td>6.919</td>
<td>6.084</td>
<td>0.000</td>
<td>28.533</td>
<td>55.655</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">age</th>
<td>0.0138</td>
<td>0.009</td>
<td>1.582</td>
<td>0.114</td>
<td>-0.003</td>
<td>0.031</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">dis</th>
<td>0.2061</td>
<td>0.146</td>
<td>1.411</td>
<td>0.158</td>
<td>-0.080</td>
<td>0.492</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">rad</th>
<td>0.5982</td>
<td>0.116</td>
<td>5.159</td>
<td>0.000</td>
<td>0.371</td>
<td>0.825</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">tax</th>
<td>-0.0073</td>
<td>0.002</td>
<td>-3.072</td>
<td>0.002</td>
<td>-0.012</td>
<td>-0.003</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="324b8a02" class="cell" data-execution_count="62">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>probs<span class="op">=</span>res.predict()</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>np.array([<span class="dv">0</span>]<span class="op">*</span>Boston.shape[<span class="dv">0</span>])</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>labels[probs<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(labels,Boston.crim_ab)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>225</td>
<td>40</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>28</td>
<td>213</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="60983575" class="cell" data-execution_count="63">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">225</span><span class="op">+</span><span class="dv">213</span>)<span class="op">/</span>(<span class="dv">225</span><span class="op">+</span><span class="dv">213</span><span class="op">+</span><span class="dv">28</span><span class="op">+</span><span class="dv">40</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>0.8656126482213439</code></pre>
</div>
</div>
<p>The fraction of correct answers for logistic regression is around 87%.</p>
<div id="3e4d8f37" class="cell" data-execution_count="64">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>lda<span class="op">=</span>LDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>lda.fit(x_train, y_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="64">
<style>#sk-container-id-8 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-8 {
  color: var(--sklearn-color-text);
}

#sk-container-id-8 pre {
  padding: 0;
}

#sk-container-id-8 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-8 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-8 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-8 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-8 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-8 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-8 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-8 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-8 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-8 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-8 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-8 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-8 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-8 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-8 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-8 div.sk-label label.sk-toggleable__label,
#sk-container-id-8 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-8 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-8 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-8 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-8 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-8 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-8 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-8 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-8 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-8 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearDiscriminantAnalysis(store_covariance=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" checked=""><label for="sk-estimator-id-8" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;LinearDiscriminantAnalysis<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html">?<span>Documentation for LinearDiscriminantAnalysis</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>LinearDiscriminantAnalysis(store_covariance=True)</pre></div> </div></div></div></div>
</div>
</div>
<div id="c664fb5e" class="cell" data-execution_count="65">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>lda_pred<span class="op">=</span>lda.predict(x_test)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(lda_pred,y_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>57</td>
<td>20</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>3</td>
<td>47</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ef92e686" class="cell" data-execution_count="66">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, lda.predict(x_test))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>0.8188976377952756</code></pre>
</div>
</div>
<p>The fraction of correct answers for LDA is around 82%.</p>
<div id="7885edba" class="cell" data-execution_count="67">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>NB <span class="op">=</span> GaussianNB()</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>NB.fit(x_train, y_train)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="67">
<style>#sk-container-id-9 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-9 {
  color: var(--sklearn-color-text);
}

#sk-container-id-9 pre {
  padding: 0;
}

#sk-container-id-9 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-9 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-9 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-9 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-9 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-9 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-9 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-9 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-9 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-9 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-9 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-9 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-9 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-9 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-9 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-9 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-9 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-9 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-9 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-9 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-9 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-9 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-9 div.sk-label label.sk-toggleable__label,
#sk-container-id-9 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-9 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-9 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-9 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-9 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-9 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-9 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-9 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-9 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-9 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-9 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-9 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-9 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-9" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" checked=""><label for="sk-estimator-id-9" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GaussianNB<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.naive_bayes.GaussianNB.html">?<span>Documentation for GaussianNB</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GaussianNB()</pre></div> </div></div></div></div>
</div>
</div>
<div id="5d626c94" class="cell" data-execution_count="68">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>NB_pred<span class="op">=</span>NB.predict(x_test)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(NB_pred,y_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Truth</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Predicted</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>55</td>
<td>19</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>5</td>
<td>48</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="67f034d9" class="cell" data-execution_count="69">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, NB_pred)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>0.8110236220472441</code></pre>
</div>
</div>
<p>The fraction of correct answers for LDA is around 81%.</p>
<div id="498e7726" class="cell" data-execution_count="70">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">31</span>):</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>k)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    knn.fit(x_train, y_train)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> accuracy_score(y_test, knn.predict(x_test))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'K=</span><span class="sc">{:3}</span><span class="st">, accuracy = </span><span class="sc">{:.4f}</span><span class="st">'</span>.<span class="bu">format</span>(k, acc))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>K=  1, accuracy = 0.9370
K=  2, accuracy = 0.9213
K=  3, accuracy = 0.9213
K=  4, accuracy = 0.9134
K=  5, accuracy = 0.9055
K=  6, accuracy = 0.9134
K=  7, accuracy = 0.8819
K=  8, accuracy = 0.8819
K=  9, accuracy = 0.8819
K= 10, accuracy = 0.8740
K= 11, accuracy = 0.8819
K= 12, accuracy = 0.8819
K= 13, accuracy = 0.8819
K= 14, accuracy = 0.8583
K= 15, accuracy = 0.8583
K= 16, accuracy = 0.8425
K= 17, accuracy = 0.8346
K= 18, accuracy = 0.8425
K= 19, accuracy = 0.8189
K= 20, accuracy = 0.8189
K= 21, accuracy = 0.8189
K= 22, accuracy = 0.8189
K= 23, accuracy = 0.8189
K= 24, accuracy = 0.8189
K= 25, accuracy = 0.8189
K= 26, accuracy = 0.8189
K= 27, accuracy = 0.8189
K= 28, accuracy = 0.8189
K= 29, accuracy = 0.8110
K= 30, accuracy = 0.8110</code></pre>
</div>
</div>
<p>Best K=1 with an accuracy score of 94%.</p>
<p>We conclude that KNN-1 is the best prediction model used for the subset of selected predictors.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Statistical Learning Analysis Report"</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Chapter 4: ISLR2 Exercise Solutions"</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Shad Ali Shah"</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 3</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show code"</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="co">    colorlinks: true</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="co">    link-citations: true</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: kable</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-cap-location: bottom</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a><span class="co">    tbl-cap-location: top</span></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a><span class="co">    crossref:</span></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a><span class="co">      fig-title: "Figure"</span></span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a><span class="co">      tbl-title: "Table"</span></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a><span class="co">      fig-prefix: "Fig."</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a><span class="co">      tbl-prefix: "Table"</span></span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a><span class="co">  error: true</span></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: false</span></span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a><span class="co">  keep-going: true</span></span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-width: 6.5</span></span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a><span class="co">  fig-height: 4</span></span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 13</span></span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots</span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ISLP</span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ISLP <span class="im">import</span> load_data</span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ISLP.models <span class="im">import</span> (ModelSpec <span class="im">as</span> MS,summarize)</span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> <span class="op">\</span></span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>     (LinearDiscriminantAnalysis <span class="im">as</span> LDA,</span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>      QuadraticDiscriminantAnalysis <span class="im">as</span> QDA)</span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb93-62"><a href="#cb93-62" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb93-63"><a href="#cb93-63" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb93-64"><a href="#cb93-64" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb93-65"><a href="#cb93-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-66"><a href="#cb93-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-69"><a href="#cb93-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-70"><a href="#cb93-70" aria-hidden="true" tabindex="-1"></a>Weekly<span class="op">=</span>load_data(<span class="st">"Weekly"</span>)</span>
<span id="cb93-71"><a href="#cb93-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-72"><a href="#cb93-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-75"><a href="#cb93-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-76"><a href="#cb93-76" aria-hidden="true" tabindex="-1"></a>Weekly.head()</span>
<span id="cb93-77"><a href="#cb93-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-78"><a href="#cb93-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-79"><a href="#cb93-79" aria-hidden="true" tabindex="-1"></a><span class="fu">### (a)</span></span>
<span id="cb93-80"><a href="#cb93-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-81"><a href="#cb93-81" aria-hidden="true" tabindex="-1"></a>First step to look for patterns is to draw statistical description of data. For this we can use the method describe() as follows:</span>
<span id="cb93-82"><a href="#cb93-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-85"><a href="#cb93-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-86"><a href="#cb93-86" aria-hidden="true" tabindex="-1"></a>Weekly.describe()</span>
<span id="cb93-87"><a href="#cb93-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-88"><a href="#cb93-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-91"><a href="#cb93-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-92"><a href="#cb93-92" aria-hidden="true" tabindex="-1"></a>Weekly.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-93"><a href="#cb93-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-94"><a href="#cb93-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-95"><a href="#cb93-95" aria-hidden="true" tabindex="-1"></a>Thanks to the correlation matrix, the only predictible trend is between Volume and Year. But let's draw graphs as the question asks.</span>
<span id="cb93-96"><a href="#cb93-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-99"><a href="#cb93-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-100"><a href="#cb93-100" aria-hidden="true" tabindex="-1"></a>sns.pairplot(Weekly)<span class="op">;</span></span>
<span id="cb93-101"><a href="#cb93-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-102"><a href="#cb93-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-105"><a href="#cb93-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-106"><a href="#cb93-106" aria-hidden="true" tabindex="-1"></a>plt.scatter(Weekly[<span class="st">'Year'</span>],Weekly[<span class="st">'Volume'</span>])<span class="op">;</span></span>
<span id="cb93-107"><a href="#cb93-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-108"><a href="#cb93-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-109"><a href="#cb93-109" aria-hidden="true" tabindex="-1"></a>Given the plots shown above, the only visible pattern is the one which relates Year to Volume</span>
<span id="cb93-110"><a href="#cb93-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-111"><a href="#cb93-111" aria-hidden="true" tabindex="-1"></a><span class="fu">### (b)</span></span>
<span id="cb93-112"><a href="#cb93-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-115"><a href="#cb93-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-116"><a href="#cb93-116" aria-hidden="true" tabindex="-1"></a>allvars<span class="op">=</span>Weekly.columns.drop([<span class="st">'Today'</span>,<span class="st">'Direction'</span>,<span class="st">'Year'</span>])</span>
<span id="cb93-117"><a href="#cb93-117" aria-hidden="true" tabindex="-1"></a>design<span class="op">=</span>MS(allvars)</span>
<span id="cb93-118"><a href="#cb93-118" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>design.fit_transform(Weekly)</span>
<span id="cb93-119"><a href="#cb93-119" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>Weekly.Direction<span class="op">==</span><span class="st">'Up'</span></span>
<span id="cb93-120"><a href="#cb93-120" aria-hidden="true" tabindex="-1"></a>glm<span class="op">=</span>sm.GLM(y,X,family<span class="op">=</span>sm.families.Binomial())</span>
<span id="cb93-121"><a href="#cb93-121" aria-hidden="true" tabindex="-1"></a>res<span class="op">=</span>glm.fit()</span>
<span id="cb93-122"><a href="#cb93-122" aria-hidden="true" tabindex="-1"></a>res.summary()</span>
<span id="cb93-123"><a href="#cb93-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-124"><a href="#cb93-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-125"><a href="#cb93-125" aria-hidden="true" tabindex="-1"></a>Only Lag2 seems to be statistically significant.</span>
<span id="cb93-126"><a href="#cb93-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-127"><a href="#cb93-127" aria-hidden="true" tabindex="-1"></a><span class="fu">### (c)</span></span>
<span id="cb93-128"><a href="#cb93-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-131"><a href="#cb93-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-132"><a href="#cb93-132" aria-hidden="true" tabindex="-1"></a>probs<span class="op">=</span>res.predict()</span>
<span id="cb93-133"><a href="#cb93-133" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>np.array([<span class="st">'Down'</span>]<span class="op">*</span><span class="dv">1089</span>)</span>
<span id="cb93-134"><a href="#cb93-134" aria-hidden="true" tabindex="-1"></a>labels[probs<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="st">"Up"</span></span>
<span id="cb93-135"><a href="#cb93-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-136"><a href="#cb93-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-139"><a href="#cb93-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-140"><a href="#cb93-140" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(labels,Weekly.Direction)</span>
<span id="cb93-141"><a href="#cb93-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-142"><a href="#cb93-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-145"><a href="#cb93-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-146"><a href="#cb93-146" aria-hidden="true" tabindex="-1"></a>(<span class="dv">557</span><span class="op">+</span><span class="dv">54</span>)<span class="op">/</span>(<span class="dv">54</span><span class="op">+</span><span class="dv">557</span><span class="op">+</span><span class="dv">430</span><span class="op">+</span><span class="dv">48</span>)</span>
<span id="cb93-147"><a href="#cb93-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-148"><a href="#cb93-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-149"><a href="#cb93-149" aria-hidden="true" tabindex="-1"></a>The accuracy rate is 56%, slightly better than random guessing. Given that we chose that 'up' is the positive direction, the error rate is mainly due to false positive classification. Which means that 430 stocks are predicted to go up by the model while they truly go down.  </span>
<span id="cb93-150"><a href="#cb93-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-151"><a href="#cb93-151" aria-hidden="true" tabindex="-1"></a><span class="fu">### (d)</span></span>
<span id="cb93-152"><a href="#cb93-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-155"><a href="#cb93-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-156"><a href="#cb93-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting the asked period and the corresponding training set with Lag2 as the only predictor</span></span>
<span id="cb93-157"><a href="#cb93-157" aria-hidden="true" tabindex="-1"></a>train<span class="op">=</span>(Weekly.Year<span class="op">&lt;</span><span class="dv">2009</span>)</span>
<span id="cb93-158"><a href="#cb93-158" aria-hidden="true" tabindex="-1"></a>W_train<span class="op">=</span>Weekly.loc[train].Lag2</span>
<span id="cb93-159"><a href="#cb93-159" aria-hidden="true" tabindex="-1"></a>W_test<span class="op">=</span>Weekly.loc[<span class="op">~</span>train].Lag2</span>
<span id="cb93-160"><a href="#cb93-160" aria-hidden="true" tabindex="-1"></a>W_test.shape</span>
<span id="cb93-161"><a href="#cb93-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-162"><a href="#cb93-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-165"><a href="#cb93-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-166"><a href="#cb93-166" aria-hidden="true" tabindex="-1"></a><span class="co">#Refitting the new model</span></span>
<span id="cb93-167"><a href="#cb93-167" aria-hidden="true" tabindex="-1"></a>X_train, X_test <span class="op">=</span> X.loc[train].Lag2, X.loc[<span class="op">~</span>train].Lag2</span>
<span id="cb93-168"><a href="#cb93-168" aria-hidden="true" tabindex="-1"></a>y_train, y_test <span class="op">=</span> y.loc[train], y.loc[<span class="op">~</span>train]</span>
<span id="cb93-169"><a href="#cb93-169" aria-hidden="true" tabindex="-1"></a>glm_train <span class="op">=</span> sm.GLM(y_train,</span>
<span id="cb93-170"><a href="#cb93-170" aria-hidden="true" tabindex="-1"></a>                   X_train,</span>
<span id="cb93-171"><a href="#cb93-171" aria-hidden="true" tabindex="-1"></a>                   family<span class="op">=</span>sm.families.Binomial())</span>
<span id="cb93-172"><a href="#cb93-172" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> glm_train.fit()</span>
<span id="cb93-173"><a href="#cb93-173" aria-hidden="true" tabindex="-1"></a><span class="co">#Designing the probabilities based on the training set</span></span>
<span id="cb93-174"><a href="#cb93-174" aria-hidden="true" tabindex="-1"></a>probs <span class="op">=</span> results.predict(exog<span class="op">=</span>X_test)</span>
<span id="cb93-175"><a href="#cb93-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-176"><a href="#cb93-176" aria-hidden="true" tabindex="-1"></a>X_t<span class="op">=</span>np.array(X_train)</span>
<span id="cb93-177"><a href="#cb93-177" aria-hidden="true" tabindex="-1"></a>XX<span class="op">=</span>X_t.reshape(np.shape(X_t)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-178"><a href="#cb93-178" aria-hidden="true" tabindex="-1"></a>X_ts<span class="op">=</span>np.array(X_test)</span>
<span id="cb93-179"><a href="#cb93-179" aria-hidden="true" tabindex="-1"></a>Xts<span class="op">=</span>X_ts.reshape(np.shape(X_ts)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-180"><a href="#cb93-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-181"><a href="#cb93-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-184"><a href="#cb93-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-185"><a href="#cb93-185" aria-hidden="true" tabindex="-1"></a><span class="co">#Preparing the test set to compare with the corresponding training set in the confusion matrix</span></span>
<span id="cb93-186"><a href="#cb93-186" aria-hidden="true" tabindex="-1"></a>D<span class="op">=</span>Weekly.Direction</span>
<span id="cb93-187"><a href="#cb93-187" aria-hidden="true" tabindex="-1"></a>Test_set<span class="op">=</span>D.loc[<span class="op">~</span>train]</span>
<span id="cb93-188"><a href="#cb93-188" aria-hidden="true" tabindex="-1"></a>Train_set<span class="op">=</span>D.loc[train]</span>
<span id="cb93-189"><a href="#cb93-189" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting the probs matrix to a matrix filled with direction values</span></span>
<span id="cb93-190"><a href="#cb93-190" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>np.array([<span class="st">'Down'</span>]<span class="op">*</span><span class="dv">104</span>)</span>
<span id="cb93-191"><a href="#cb93-191" aria-hidden="true" tabindex="-1"></a>labels[probs<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="st">'Up'</span></span>
<span id="cb93-192"><a href="#cb93-192" aria-hidden="true" tabindex="-1"></a>C<span class="op">=</span>ISLP.confusion_table(labels,Test_set)</span>
<span id="cb93-193"><a href="#cb93-193" aria-hidden="true" tabindex="-1"></a>Train_s<span class="op">=</span>np.array(Train_set)</span>
<span id="cb93-194"><a href="#cb93-194" aria-hidden="true" tabindex="-1"></a>TT<span class="op">=</span>Train_s.reshape(np.shape(Train_set)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-195"><a href="#cb93-195" aria-hidden="true" tabindex="-1"></a>Test_s<span class="op">=</span>np.array(Test_set)</span>
<span id="cb93-196"><a href="#cb93-196" aria-hidden="true" tabindex="-1"></a>TS<span class="op">=</span>Test_s.reshape(np.shape(Test_s)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-197"><a href="#cb93-197" aria-hidden="true" tabindex="-1"></a>TS.shape</span>
<span id="cb93-198"><a href="#cb93-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-199"><a href="#cb93-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-202"><a href="#cb93-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-203"><a href="#cb93-203" aria-hidden="true" tabindex="-1"></a>C</span>
<span id="cb93-204"><a href="#cb93-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-205"><a href="#cb93-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-208"><a href="#cb93-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-209"><a href="#cb93-209" aria-hidden="true" tabindex="-1"></a>(<span class="dv">20</span><span class="op">+</span><span class="dv">37</span>)<span class="op">/</span><span class="dv">104</span></span>
<span id="cb93-210"><a href="#cb93-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-211"><a href="#cb93-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-212"><a href="#cb93-212" aria-hidden="true" tabindex="-1"></a>The rate of correct predictions on the held out data is around 55%. </span>
<span id="cb93-213"><a href="#cb93-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-214"><a href="#cb93-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### (e)</span></span>
<span id="cb93-215"><a href="#cb93-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-218"><a href="#cb93-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-219"><a href="#cb93-219" aria-hidden="true" tabindex="-1"></a>lda<span class="op">=</span>LDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-220"><a href="#cb93-220" aria-hidden="true" tabindex="-1"></a>lda.fit(XX, Train_set)</span>
<span id="cb93-221"><a href="#cb93-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-222"><a href="#cb93-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-225"><a href="#cb93-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-226"><a href="#cb93-226" aria-hidden="true" tabindex="-1"></a>lda_pred<span class="op">=</span>lda.predict(Xts)</span>
<span id="cb93-227"><a href="#cb93-227" aria-hidden="true" tabindex="-1"></a>lda_predm<span class="op">=</span>np.array(lda_pred)</span>
<span id="cb93-228"><a href="#cb93-228" aria-hidden="true" tabindex="-1"></a>lda_predm1<span class="op">=</span>lda_predm.reshape(np.shape(lda_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-229"><a href="#cb93-229" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(lda_predm1,TS)</span>
<span id="cb93-230"><a href="#cb93-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-231"><a href="#cb93-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-234"><a href="#cb93-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-235"><a href="#cb93-235" aria-hidden="true" tabindex="-1"></a>(<span class="dv">9</span><span class="op">+</span><span class="dv">56</span>)<span class="op">/</span><span class="dv">104</span></span>
<span id="cb93-236"><a href="#cb93-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-237"><a href="#cb93-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-238"><a href="#cb93-238" aria-hidden="true" tabindex="-1"></a>LDA performs better than logistic regression since Lag2 seems to follow a normal distribution from the previous correlation plot.</span>
<span id="cb93-239"><a href="#cb93-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-240"><a href="#cb93-240" aria-hidden="true" tabindex="-1"></a><span class="fu">### (f)</span></span>
<span id="cb93-241"><a href="#cb93-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-244"><a href="#cb93-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-245"><a href="#cb93-245" aria-hidden="true" tabindex="-1"></a>qda<span class="op">=</span>QDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-246"><a href="#cb93-246" aria-hidden="true" tabindex="-1"></a>qda.fit(XX, Train_set)</span>
<span id="cb93-247"><a href="#cb93-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-248"><a href="#cb93-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-251"><a href="#cb93-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-252"><a href="#cb93-252" aria-hidden="true" tabindex="-1"></a>qda_pred<span class="op">=</span>qda.predict(Xts)</span>
<span id="cb93-253"><a href="#cb93-253" aria-hidden="true" tabindex="-1"></a>qda_predm<span class="op">=</span>np.array(qda_pred)</span>
<span id="cb93-254"><a href="#cb93-254" aria-hidden="true" tabindex="-1"></a>qda_predm1<span class="op">=</span>qda_predm.reshape(np.shape(lda_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-255"><a href="#cb93-255" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(qda_predm1,TS)</span>
<span id="cb93-256"><a href="#cb93-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-257"><a href="#cb93-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-260"><a href="#cb93-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-261"><a href="#cb93-261" aria-hidden="true" tabindex="-1"></a><span class="dv">61</span><span class="op">/</span>(<span class="dv">61</span><span class="op">+</span><span class="dv">43</span>)</span>
<span id="cb93-262"><a href="#cb93-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-263"><a href="#cb93-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-264"><a href="#cb93-264" aria-hidden="true" tabindex="-1"></a>Fraction of correct answers for QDA is around 59%, which means that it is lower than LDA but better than logistic regression. The QDA is better here than logistic regression for the same reason as for the LDA. However, LDA gives a better prediction than QDA since there are no signs of interactions among predictors.</span>
<span id="cb93-265"><a href="#cb93-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-266"><a href="#cb93-266" aria-hidden="true" tabindex="-1"></a><span class="fu">### (g)</span></span>
<span id="cb93-267"><a href="#cb93-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-270"><a href="#cb93-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-271"><a href="#cb93-271" aria-hidden="true" tabindex="-1"></a>knn1 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb93-272"><a href="#cb93-272" aria-hidden="true" tabindex="-1"></a>knn1.fit(XX, Train_set)</span>
<span id="cb93-273"><a href="#cb93-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-274"><a href="#cb93-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-277"><a href="#cb93-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-278"><a href="#cb93-278" aria-hidden="true" tabindex="-1"></a>knn1_pred<span class="op">=</span>knn1.predict(Xts)</span>
<span id="cb93-279"><a href="#cb93-279" aria-hidden="true" tabindex="-1"></a>knn1_predm<span class="op">=</span>np.array(knn1_pred)</span>
<span id="cb93-280"><a href="#cb93-280" aria-hidden="true" tabindex="-1"></a>knn1_predm1<span class="op">=</span>knn1_predm.reshape(np.shape(knn1_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-281"><a href="#cb93-281" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(knn1_predm1,TS)</span>
<span id="cb93-282"><a href="#cb93-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-283"><a href="#cb93-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-286"><a href="#cb93-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-287"><a href="#cb93-287" aria-hidden="true" tabindex="-1"></a>(<span class="dv">22</span><span class="op">+</span><span class="dv">30</span>)<span class="op">/</span><span class="dv">104</span></span>
<span id="cb93-288"><a href="#cb93-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-289"><a href="#cb93-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-290"><a href="#cb93-290" aria-hidden="true" tabindex="-1"></a>Since the LDA outperforms QDA we can already expect that KNN will perform poorly. The decision boundary</span>
<span id="cb93-291"><a href="#cb93-291" aria-hidden="true" tabindex="-1"></a>should be linear. Furthermore, the rate giving the number of observations over the number of predictors is around 17, which is not large enough to justify such a non parametric technique.</span>
<span id="cb93-292"><a href="#cb93-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-293"><a href="#cb93-293" aria-hidden="true" tabindex="-1"></a><span class="fu">### (h)</span></span>
<span id="cb93-294"><a href="#cb93-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-297"><a href="#cb93-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-298"><a href="#cb93-298" aria-hidden="true" tabindex="-1"></a>NB <span class="op">=</span> GaussianNB()</span>
<span id="cb93-299"><a href="#cb93-299" aria-hidden="true" tabindex="-1"></a>NB.fit(XX, Train_set)</span>
<span id="cb93-300"><a href="#cb93-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-301"><a href="#cb93-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-304"><a href="#cb93-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-305"><a href="#cb93-305" aria-hidden="true" tabindex="-1"></a>NB_pred<span class="op">=</span>NB.predict(Xts)</span>
<span id="cb93-306"><a href="#cb93-306" aria-hidden="true" tabindex="-1"></a>NB_predm<span class="op">=</span>np.array(NB_pred)</span>
<span id="cb93-307"><a href="#cb93-307" aria-hidden="true" tabindex="-1"></a>NB_predm1<span class="op">=</span>NB_predm.reshape(np.shape(NB_predm)[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb93-308"><a href="#cb93-308" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(NB_predm1,TS)</span>
<span id="cb93-309"><a href="#cb93-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-310"><a href="#cb93-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-313"><a href="#cb93-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-314"><a href="#cb93-314" aria-hidden="true" tabindex="-1"></a><span class="dv">61</span><span class="op">/</span><span class="dv">104</span></span>
<span id="cb93-315"><a href="#cb93-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-316"><a href="#cb93-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-317"><a href="#cb93-317" aria-hidden="true" tabindex="-1"></a><span class="fu">### (i)</span></span>
<span id="cb93-318"><a href="#cb93-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-319"><a href="#cb93-319" aria-hidden="true" tabindex="-1"></a>LDA appears to give the best results on the data set.</span>
<span id="cb93-320"><a href="#cb93-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-321"><a href="#cb93-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 14</span></span>
<span id="cb93-322"><a href="#cb93-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-323"><a href="#cb93-323" aria-hidden="true" tabindex="-1"></a><span class="fu">### (a)</span></span>
<span id="cb93-324"><a href="#cb93-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-327"><a href="#cb93-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-328"><a href="#cb93-328" aria-hidden="true" tabindex="-1"></a>Auto<span class="op">=</span>load_data(<span class="st">"Auto"</span>)</span>
<span id="cb93-329"><a href="#cb93-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-330"><a href="#cb93-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-333"><a href="#cb93-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-334"><a href="#cb93-334" aria-hidden="true" tabindex="-1"></a>Auto.head()</span>
<span id="cb93-335"><a href="#cb93-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-336"><a href="#cb93-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-339"><a href="#cb93-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-340"><a href="#cb93-340" aria-hidden="true" tabindex="-1"></a>mpg01<span class="op">=</span>np.where(Auto[<span class="st">"mpg"</span>]<span class="op">&gt;</span>Auto[<span class="st">"mpg"</span>].median(),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb93-341"><a href="#cb93-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-342"><a href="#cb93-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-345"><a href="#cb93-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-346"><a href="#cb93-346" aria-hidden="true" tabindex="-1"></a>Auto[<span class="st">'mpg01'</span>]<span class="op">=</span>mpg01</span>
<span id="cb93-347"><a href="#cb93-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-348"><a href="#cb93-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-349"><a href="#cb93-349" aria-hidden="true" tabindex="-1"></a><span class="fu">### (b)</span></span>
<span id="cb93-350"><a href="#cb93-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-353"><a href="#cb93-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-354"><a href="#cb93-354" aria-hidden="true" tabindex="-1"></a>Auto.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-355"><a href="#cb93-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-356"><a href="#cb93-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-359"><a href="#cb93-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-360"><a href="#cb93-360" aria-hidden="true" tabindex="-1"></a>sns.pairplot(Auto)<span class="op">;</span></span>
<span id="cb93-361"><a href="#cb93-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-362"><a href="#cb93-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-363"><a href="#cb93-363" aria-hidden="true" tabindex="-1"></a>From the graph and the correlation matrix we can conclude that there may be a significant correlation among mpg01, displacement, weight and cylinders.</span>
<span id="cb93-364"><a href="#cb93-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-367"><a href="#cb93-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-368"><a href="#cb93-368" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>Auto[[<span class="st">'weight'</span>,<span class="st">'displacement'</span>,<span class="st">'cylinders'</span>]].values</span>
<span id="cb93-369"><a href="#cb93-369" aria-hidden="true" tabindex="-1"></a><span class="co">#the values attribute is used to convert x from a dataframe object to an array</span></span>
<span id="cb93-370"><a href="#cb93-370" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>Auto[<span class="st">'mpg01'</span>].values</span>
<span id="cb93-371"><a href="#cb93-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-372"><a href="#cb93-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-373"><a href="#cb93-373" aria-hidden="true" tabindex="-1"></a><span class="fu">### (c)</span></span>
<span id="cb93-374"><a href="#cb93-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-377"><a href="#cb93-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-378"><a href="#cb93-378" aria-hidden="true" tabindex="-1"></a>(X_train,X_test,y_train,y_test) <span class="op">=</span> train_test_split(x,y,random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb93-379"><a href="#cb93-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-380"><a href="#cb93-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-381"><a href="#cb93-381" aria-hidden="true" tabindex="-1"></a><span class="fu">### (d)</span></span>
<span id="cb93-382"><a href="#cb93-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-385"><a href="#cb93-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-386"><a href="#cb93-386" aria-hidden="true" tabindex="-1"></a>lda<span class="op">=</span>LDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-387"><a href="#cb93-387" aria-hidden="true" tabindex="-1"></a>lda.fit(X_train, y_train)</span>
<span id="cb93-388"><a href="#cb93-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-389"><a href="#cb93-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-392"><a href="#cb93-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-393"><a href="#cb93-393" aria-hidden="true" tabindex="-1"></a>lda_pred<span class="op">=</span>lda.predict(X_test)</span>
<span id="cb93-394"><a href="#cb93-394" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(lda_pred,y_test)</span>
<span id="cb93-395"><a href="#cb93-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-396"><a href="#cb93-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-399"><a href="#cb93-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-400"><a href="#cb93-400" aria-hidden="true" tabindex="-1"></a>(<span class="dv">49</span><span class="op">+</span><span class="dv">42</span>)<span class="op">/</span>(<span class="dv">49</span><span class="op">+</span><span class="dv">42</span><span class="op">+</span><span class="dv">5</span><span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb93-401"><a href="#cb93-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-402"><a href="#cb93-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-405"><a href="#cb93-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-406"><a href="#cb93-406" aria-hidden="true" tabindex="-1"></a>LDA_test_err<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, lda.predict(X_test))</span>
<span id="cb93-407"><a href="#cb93-407" aria-hidden="true" tabindex="-1"></a>LDA_test_err</span>
<span id="cb93-408"><a href="#cb93-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-409"><a href="#cb93-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-410"><a href="#cb93-410" aria-hidden="true" tabindex="-1"></a>The test error obtained for the LDA model is 7%.</span>
<span id="cb93-411"><a href="#cb93-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-412"><a href="#cb93-412" aria-hidden="true" tabindex="-1"></a><span class="fu">### (e)</span></span>
<span id="cb93-413"><a href="#cb93-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-416"><a href="#cb93-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-417"><a href="#cb93-417" aria-hidden="true" tabindex="-1"></a>qda<span class="op">=</span>QDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-418"><a href="#cb93-418" aria-hidden="true" tabindex="-1"></a>qda.fit(X_train, y_train)</span>
<span id="cb93-419"><a href="#cb93-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-420"><a href="#cb93-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-423"><a href="#cb93-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-424"><a href="#cb93-424" aria-hidden="true" tabindex="-1"></a>qda_pred<span class="op">=</span>qda.predict(X_test)</span>
<span id="cb93-425"><a href="#cb93-425" aria-hidden="true" tabindex="-1"></a>QDA_test_err<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, qda.predict(X_test))</span>
<span id="cb93-426"><a href="#cb93-426" aria-hidden="true" tabindex="-1"></a>QDA_test_err</span>
<span id="cb93-427"><a href="#cb93-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-428"><a href="#cb93-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-429"><a href="#cb93-429" aria-hidden="true" tabindex="-1"></a>The test error obtained for the LDA model is 6%.</span>
<span id="cb93-430"><a href="#cb93-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-431"><a href="#cb93-431" aria-hidden="true" tabindex="-1"></a><span class="fu">### (f)</span></span>
<span id="cb93-432"><a href="#cb93-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-435"><a href="#cb93-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-436"><a href="#cb93-436" aria-hidden="true" tabindex="-1"></a>lr<span class="op">=</span>LogisticRegression()</span>
<span id="cb93-437"><a href="#cb93-437" aria-hidden="true" tabindex="-1"></a>result<span class="op">=</span>lr.fit(X_train,y_train)</span>
<span id="cb93-438"><a href="#cb93-438" aria-hidden="true" tabindex="-1"></a>lr_test_error<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, lr.predict(X_test))</span>
<span id="cb93-439"><a href="#cb93-439" aria-hidden="true" tabindex="-1"></a>lr_test_error</span>
<span id="cb93-440"><a href="#cb93-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-441"><a href="#cb93-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-442"><a href="#cb93-442" aria-hidden="true" tabindex="-1"></a>The test error obtained for the logistic regression model is 6%.</span>
<span id="cb93-443"><a href="#cb93-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-444"><a href="#cb93-444" aria-hidden="true" tabindex="-1"></a><span class="fu">### (g)</span></span>
<span id="cb93-445"><a href="#cb93-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-448"><a href="#cb93-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-449"><a href="#cb93-449" aria-hidden="true" tabindex="-1"></a>NB <span class="op">=</span> GaussianNB()</span>
<span id="cb93-450"><a href="#cb93-450" aria-hidden="true" tabindex="-1"></a>NB.fit(X_train, y_train)</span>
<span id="cb93-451"><a href="#cb93-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-452"><a href="#cb93-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-455"><a href="#cb93-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-456"><a href="#cb93-456" aria-hidden="true" tabindex="-1"></a>NB_pred<span class="op">=</span>NB.predict(X_test)</span>
<span id="cb93-457"><a href="#cb93-457" aria-hidden="true" tabindex="-1"></a>NB_test_error<span class="op">=</span><span class="dv">1</span><span class="op">-</span>accuracy_score(y_test, NB_pred)</span>
<span id="cb93-458"><a href="#cb93-458" aria-hidden="true" tabindex="-1"></a>NB_test_error</span>
<span id="cb93-459"><a href="#cb93-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-460"><a href="#cb93-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-461"><a href="#cb93-461" aria-hidden="true" tabindex="-1"></a>The test error obtained for Naive Bayes model is 7%.</span>
<span id="cb93-462"><a href="#cb93-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-463"><a href="#cb93-463" aria-hidden="true" tabindex="-1"></a><span class="fu">### (h)</span></span>
<span id="cb93-464"><a href="#cb93-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-467"><a href="#cb93-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-468"><a href="#cb93-468" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">101</span>):</span>
<span id="cb93-469"><a href="#cb93-469" aria-hidden="true" tabindex="-1"></a>    knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>k)</span>
<span id="cb93-470"><a href="#cb93-470" aria-hidden="true" tabindex="-1"></a>    knn.fit(X_train, y_train)</span>
<span id="cb93-471"><a href="#cb93-471" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> accuracy_score(y_test, knn.predict(X_test))</span>
<span id="cb93-472"><a href="#cb93-472" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'K=</span><span class="sc">{:3}</span><span class="st">, accuracy = </span><span class="sc">{:.4f}</span><span class="st">'</span>.<span class="bu">format</span>(k, acc))</span>
<span id="cb93-473"><a href="#cb93-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-474"><a href="#cb93-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-475"><a href="#cb93-475" aria-hidden="true" tabindex="-1"></a>The value of 13 for K seems to give the best result for the KNN model.</span>
<span id="cb93-476"><a href="#cb93-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-477"><a href="#cb93-477" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 15</span></span>
<span id="cb93-478"><a href="#cb93-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-479"><a href="#cb93-479" aria-hidden="true" tabindex="-1"></a><span class="fu">### (a)</span></span>
<span id="cb93-480"><a href="#cb93-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-483"><a href="#cb93-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-484"><a href="#cb93-484" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Power():</span>
<span id="cb93-485"><a href="#cb93-485" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">2</span><span class="op">**</span><span class="dv">3</span>)</span>
<span id="cb93-486"><a href="#cb93-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-487"><a href="#cb93-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-488"><a href="#cb93-488" aria-hidden="true" tabindex="-1"></a><span class="fu">### (b)</span></span>
<span id="cb93-489"><a href="#cb93-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-492"><a href="#cb93-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-493"><a href="#cb93-493" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Power2(x,a):</span>
<span id="cb93-494"><a href="#cb93-494" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x<span class="op">**</span>a)</span>
<span id="cb93-495"><a href="#cb93-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-496"><a href="#cb93-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-497"><a href="#cb93-497" aria-hidden="true" tabindex="-1"></a><span class="fu">### (c)</span></span>
<span id="cb93-498"><a href="#cb93-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-501"><a href="#cb93-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-502"><a href="#cb93-502" aria-hidden="true" tabindex="-1"></a>Power2(<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb93-503"><a href="#cb93-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-504"><a href="#cb93-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-507"><a href="#cb93-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-508"><a href="#cb93-508" aria-hidden="true" tabindex="-1"></a>Power2(<span class="dv">8</span>,<span class="dv">17</span>)</span>
<span id="cb93-509"><a href="#cb93-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-510"><a href="#cb93-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-513"><a href="#cb93-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-514"><a href="#cb93-514" aria-hidden="true" tabindex="-1"></a>Power2(<span class="dv">131</span>,<span class="dv">3</span>)</span>
<span id="cb93-515"><a href="#cb93-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-516"><a href="#cb93-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-517"><a href="#cb93-517" aria-hidden="true" tabindex="-1"></a><span class="fu">### (d)</span></span>
<span id="cb93-518"><a href="#cb93-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-521"><a href="#cb93-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-522"><a href="#cb93-522" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Power3(x,a):</span>
<span id="cb93-523"><a href="#cb93-523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">**</span>a</span>
<span id="cb93-524"><a href="#cb93-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-525"><a href="#cb93-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-526"><a href="#cb93-526" aria-hidden="true" tabindex="-1"></a><span class="fu">### (e)</span></span>
<span id="cb93-527"><a href="#cb93-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-530"><a href="#cb93-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-531"><a href="#cb93-531" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb93-532"><a href="#cb93-532" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> Power3(x,<span class="dv">2</span>)</span>
<span id="cb93-533"><a href="#cb93-533" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb93-534"><a href="#cb93-534" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb93-535"><a href="#cb93-535" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Power3() with x^2 vs x on log-scale'</span>)</span>
<span id="cb93-536"><a href="#cb93-536" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb93-537"><a href="#cb93-537" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y=x^2'</span>)</span>
<span id="cb93-538"><a href="#cb93-538" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y)<span class="op">;</span></span>
<span id="cb93-539"><a href="#cb93-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-540"><a href="#cb93-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-543"><a href="#cb93-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-544"><a href="#cb93-544" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb93-545"><a href="#cb93-545" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb93-546"><a href="#cb93-546" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb93-547"><a href="#cb93-547" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Power3() with x^2 vs x, both on log-scale'</span>)</span>
<span id="cb93-548"><a href="#cb93-548" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb93-549"><a href="#cb93-549" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'log(x^2)'</span>)</span>
<span id="cb93-550"><a href="#cb93-550" aria-hidden="true" tabindex="-1"></a>ax.plot(x,y)<span class="op">;</span></span>
<span id="cb93-551"><a href="#cb93-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-552"><a href="#cb93-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-553"><a href="#cb93-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### (f)</span></span>
<span id="cb93-554"><a href="#cb93-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-557"><a href="#cb93-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-558"><a href="#cb93-558" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> PlotPower(x,a,log<span class="op">=</span><span class="st">''</span>):</span>
<span id="cb93-559"><a href="#cb93-559" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb93-560"><a href="#cb93-560" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb93-561"><a href="#cb93-561" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb93-562"><a href="#cb93-562" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'x^%.0f vs x'</span> <span class="op">%</span>a)</span>
<span id="cb93-563"><a href="#cb93-563" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log<span class="op">==</span><span class="st">'xy'</span>:</span>
<span id="cb93-564"><a href="#cb93-564" aria-hidden="true" tabindex="-1"></a>        ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb93-565"><a href="#cb93-565" aria-hidden="true" tabindex="-1"></a>        ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb93-566"><a href="#cb93-566" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'x^%.0f vs x, both on log-scale'</span><span class="op">%</span>a)</span>
<span id="cb93-567"><a href="#cb93-567" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb93-568"><a href="#cb93-568" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'log(x^%.0f)'</span><span class="op">%</span>a)</span>
<span id="cb93-569"><a href="#cb93-569" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log<span class="op">==</span><span class="st">'x'</span>:</span>
<span id="cb93-570"><a href="#cb93-570" aria-hidden="true" tabindex="-1"></a>        ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb93-571"><a href="#cb93-571" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'x^%.0f vs log(x)'</span><span class="op">%</span>a)</span>
<span id="cb93-572"><a href="#cb93-572" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'log(x)'</span>)</span>
<span id="cb93-573"><a href="#cb93-573" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'x^%.0f'</span><span class="op">%</span>a)</span>
<span id="cb93-574"><a href="#cb93-574" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> log<span class="op">==</span><span class="st">'y'</span>:</span>
<span id="cb93-575"><a href="#cb93-575" aria-hidden="true" tabindex="-1"></a>        ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb93-576"><a href="#cb93-576" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'log(x^%.0f) vs x'</span><span class="op">%</span>a)</span>
<span id="cb93-577"><a href="#cb93-577" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb93-578"><a href="#cb93-578" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'log(x^%.0f)'</span><span class="op">%</span>a)  </span>
<span id="cb93-579"><a href="#cb93-579" aria-hidden="true" tabindex="-1"></a>    ax.plot(x,y)<span class="op">;</span></span>
<span id="cb93-580"><a href="#cb93-580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-581"><a href="#cb93-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-582"><a href="#cb93-582" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise 16</span></span>
<span id="cb93-583"><a href="#cb93-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-586"><a href="#cb93-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-587"><a href="#cb93-587" aria-hidden="true" tabindex="-1"></a>Boston<span class="op">=</span>load_data(<span class="st">'Boston'</span>)</span>
<span id="cb93-588"><a href="#cb93-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-589"><a href="#cb93-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-592"><a href="#cb93-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-593"><a href="#cb93-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a response variable and add it to the Boston data set</span></span>
<span id="cb93-594"><a href="#cb93-594" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 for crim_ab means that crime rate is above the median</span></span>
<span id="cb93-595"><a href="#cb93-595" aria-hidden="true" tabindex="-1"></a>crim_ab<span class="op">=</span>np.where(Boston[<span class="st">"crim"</span>]<span class="op">&gt;</span>Boston[<span class="st">"crim"</span>].median(),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb93-596"><a href="#cb93-596" aria-hidden="true" tabindex="-1"></a>Boston[<span class="st">'crim_ab'</span>]<span class="op">=</span>crim_ab</span>
<span id="cb93-597"><a href="#cb93-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-598"><a href="#cb93-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-601"><a href="#cb93-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-602"><a href="#cb93-602" aria-hidden="true" tabindex="-1"></a>Boston[<span class="st">'crim_ab'</span>].describe()</span>
<span id="cb93-603"><a href="#cb93-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-604"><a href="#cb93-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-607"><a href="#cb93-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-608"><a href="#cb93-608" aria-hidden="true" tabindex="-1"></a>Boston.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-609"><a href="#cb93-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-610"><a href="#cb93-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-611"><a href="#cb93-611" aria-hidden="true" tabindex="-1"></a>Features age, dis, nox, rad, tax and indus seem to be correlated with crim_ab.</span>
<span id="cb93-612"><a href="#cb93-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-615"><a href="#cb93-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-616"><a href="#cb93-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data set into training and test data set</span></span>
<span id="cb93-617"><a href="#cb93-617" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>Boston[[<span class="st">'indus'</span>,<span class="st">'nox'</span>,<span class="st">'age'</span>,<span class="st">'dis'</span>,<span class="st">'rad'</span>,<span class="st">'tax'</span>]].values</span>
<span id="cb93-618"><a href="#cb93-618" aria-hidden="true" tabindex="-1"></a><span class="co">#the values attribute is used to convert x from a dataframe object to an array</span></span>
<span id="cb93-619"><a href="#cb93-619" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>Boston[<span class="st">'crim_ab'</span>].values</span>
<span id="cb93-620"><a href="#cb93-620" aria-hidden="true" tabindex="-1"></a>(x_train,x_test,y_train,y_test)<span class="op">=</span>train_test_split(x,y,random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb93-621"><a href="#cb93-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-622"><a href="#cb93-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-625"><a href="#cb93-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-626"><a href="#cb93-626" aria-hidden="true" tabindex="-1"></a>allvars<span class="op">=</span>Boston[[<span class="st">'indus'</span>,<span class="st">'nox'</span>,<span class="st">'age'</span>,<span class="st">'dis'</span>,<span class="st">'rad'</span>,<span class="st">'tax'</span>]]</span>
<span id="cb93-627"><a href="#cb93-627" aria-hidden="true" tabindex="-1"></a>design<span class="op">=</span>MS(allvars)</span>
<span id="cb93-628"><a href="#cb93-628" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>design.fit_transform(Boston)</span>
<span id="cb93-629"><a href="#cb93-629" aria-hidden="true" tabindex="-1"></a>Y<span class="op">=</span>Boston.crim_ab<span class="op">==</span><span class="dv">1</span></span>
<span id="cb93-630"><a href="#cb93-630" aria-hidden="true" tabindex="-1"></a>glm<span class="op">=</span>sm.GLM(Y,X,family<span class="op">=</span>sm.families.Binomial())</span>
<span id="cb93-631"><a href="#cb93-631" aria-hidden="true" tabindex="-1"></a>res<span class="op">=</span>glm.fit()</span>
<span id="cb93-632"><a href="#cb93-632" aria-hidden="true" tabindex="-1"></a>res.summary()</span>
<span id="cb93-633"><a href="#cb93-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-634"><a href="#cb93-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-637"><a href="#cb93-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-638"><a href="#cb93-638" aria-hidden="true" tabindex="-1"></a>probs<span class="op">=</span>res.predict()</span>
<span id="cb93-639"><a href="#cb93-639" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>np.array([<span class="dv">0</span>]<span class="op">*</span>Boston.shape[<span class="dv">0</span>])</span>
<span id="cb93-640"><a href="#cb93-640" aria-hidden="true" tabindex="-1"></a>labels[probs<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb93-641"><a href="#cb93-641" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(labels,Boston.crim_ab)</span>
<span id="cb93-642"><a href="#cb93-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-643"><a href="#cb93-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-646"><a href="#cb93-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-647"><a href="#cb93-647" aria-hidden="true" tabindex="-1"></a>(<span class="dv">225</span><span class="op">+</span><span class="dv">213</span>)<span class="op">/</span>(<span class="dv">225</span><span class="op">+</span><span class="dv">213</span><span class="op">+</span><span class="dv">28</span><span class="op">+</span><span class="dv">40</span>)</span>
<span id="cb93-648"><a href="#cb93-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-649"><a href="#cb93-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-650"><a href="#cb93-650" aria-hidden="true" tabindex="-1"></a>The fraction of correct answers for logistic regression is around 87%.</span>
<span id="cb93-651"><a href="#cb93-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-654"><a href="#cb93-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-655"><a href="#cb93-655" aria-hidden="true" tabindex="-1"></a>lda<span class="op">=</span>LDA(store_covariance<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-656"><a href="#cb93-656" aria-hidden="true" tabindex="-1"></a>lda.fit(x_train, y_train)</span>
<span id="cb93-657"><a href="#cb93-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-658"><a href="#cb93-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-661"><a href="#cb93-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-662"><a href="#cb93-662" aria-hidden="true" tabindex="-1"></a>lda_pred<span class="op">=</span>lda.predict(x_test)</span>
<span id="cb93-663"><a href="#cb93-663" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(lda_pred,y_test)</span>
<span id="cb93-664"><a href="#cb93-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-665"><a href="#cb93-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-668"><a href="#cb93-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-669"><a href="#cb93-669" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, lda.predict(x_test))</span>
<span id="cb93-670"><a href="#cb93-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-671"><a href="#cb93-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-672"><a href="#cb93-672" aria-hidden="true" tabindex="-1"></a>The fraction of correct answers for LDA is around 82%.</span>
<span id="cb93-673"><a href="#cb93-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-676"><a href="#cb93-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-677"><a href="#cb93-677" aria-hidden="true" tabindex="-1"></a>NB <span class="op">=</span> GaussianNB()</span>
<span id="cb93-678"><a href="#cb93-678" aria-hidden="true" tabindex="-1"></a>NB.fit(x_train, y_train)</span>
<span id="cb93-679"><a href="#cb93-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-680"><a href="#cb93-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-683"><a href="#cb93-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-684"><a href="#cb93-684" aria-hidden="true" tabindex="-1"></a>NB_pred<span class="op">=</span>NB.predict(x_test)</span>
<span id="cb93-685"><a href="#cb93-685" aria-hidden="true" tabindex="-1"></a>ISLP.confusion_table(NB_pred,y_test)</span>
<span id="cb93-686"><a href="#cb93-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-687"><a href="#cb93-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-690"><a href="#cb93-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-691"><a href="#cb93-691" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, NB_pred)</span>
<span id="cb93-692"><a href="#cb93-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-693"><a href="#cb93-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-694"><a href="#cb93-694" aria-hidden="true" tabindex="-1"></a>The fraction of correct answers for LDA is around 81%.</span>
<span id="cb93-695"><a href="#cb93-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-698"><a href="#cb93-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb93-699"><a href="#cb93-699" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">31</span>):</span>
<span id="cb93-700"><a href="#cb93-700" aria-hidden="true" tabindex="-1"></a>    knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>k)</span>
<span id="cb93-701"><a href="#cb93-701" aria-hidden="true" tabindex="-1"></a>    knn.fit(x_train, y_train)</span>
<span id="cb93-702"><a href="#cb93-702" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> accuracy_score(y_test, knn.predict(x_test))</span>
<span id="cb93-703"><a href="#cb93-703" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'K=</span><span class="sc">{:3}</span><span class="st">, accuracy = </span><span class="sc">{:.4f}</span><span class="st">'</span>.<span class="bu">format</span>(k, acc))</span>
<span id="cb93-704"><a href="#cb93-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb93-705"><a href="#cb93-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-706"><a href="#cb93-706" aria-hidden="true" tabindex="-1"></a>Best K=1 with an accuracy score of 94%.</span>
<span id="cb93-707"><a href="#cb93-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-708"><a href="#cb93-708" aria-hidden="true" tabindex="-1"></a>We conclude that KNN-1 is the best prediction model used for the subset of selected predictors.</span>
<span id="cb93-709"><a href="#cb93-709" aria-hidden="true" tabindex="-1"></a></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>